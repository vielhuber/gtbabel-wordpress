!function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t,n={exports:{}};var l,a,r,i,o,u,s,c,b,d,g,_,m,p=(t||(t=1,l=n.exports,a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},r="defaultParagraphSeparator",i="formatBlock",o=function(e,t,n){return e.addEventListener(t,n)},u=function(e,t){return e.appendChild(t)},s=function(e){return document.createElement(e)},c=function(e){return document.queryCommandState(e)},b=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return document.execCommand(e,!1,t)},d={bold:{icon:"<b>B</b>",title:"Bold",state:function(){return c("bold")},result:function(){return b("bold")}},italic:{icon:"<i>I</i>",title:"Italic",state:function(){return c("italic")},result:function(){return b("italic")}},underline:{icon:"<u>U</u>",title:"Underline",state:function(){return c("underline")},result:function(){return b("underline")}},strikethrough:{icon:"<strike>S</strike>",title:"Strike-through",state:function(){return c("strikeThrough")},result:function(){return b("strikeThrough")}},heading1:{icon:"<b>H<sub>1</sub></b>",title:"Heading 1",result:function(){return b(i,"<h1>")}},heading2:{icon:"<b>H<sub>2</sub></b>",title:"Heading 2",result:function(){return b(i,"<h2>")}},paragraph:{icon:"&#182;",title:"Paragraph",result:function(){return b(i,"<p>")}},quote:{icon:"&#8220; &#8221;",title:"Quote",result:function(){return b(i,"<blockquote>")}},olist:{icon:"&#35;",title:"Ordered List",result:function(){return b("insertOrderedList")}},ulist:{icon:"&#8226;",title:"Unordered List",result:function(){return b("insertUnorderedList")}},code:{icon:"&lt;/&gt;",title:"Code",result:function(){return b(i,"<pre>")}},line:{icon:"&#8213;",title:"Horizontal Line",result:function(){return b("insertHorizontalRule")}},link:{icon:"&#128279;",title:"Link",result:function(){var e=window.prompt("Enter the link URL");e&&b("createLink",e)}},image:{icon:"&#128247;",title:"Image",result:function(){var e=window.prompt("Enter the image URL");e&&b("insertImage",e)}}},g={actionbar:"pell-actionbar",button:"pell-button",content:"pell-content",selected:"pell-button-selected"},_=function(e){var t=e.actions?e.actions.map(function(e){return"string"==typeof e?d[e]:d[e.name]?a({},d[e.name],e):e}):Object.keys(d).map(function(e){return d[e]}),n=a({},g,e.classes),l=e[r]||"div",c=s("div");c.className=n.actionbar,u(e.element,c);var _=e.element.content=s("div");return _.contentEditable=!0,_.className=n.content,_.oninput=function(t){var n=t.target.firstChild;n&&3===n.nodeType?b(i,"<"+l+">"):"<br>"===_.innerHTML&&(_.innerHTML=""),e.onChange(_.innerHTML)},_.onkeydown=function(e){var t;"Enter"===e.key&&"blockquote"===(t=i,document.queryCommandValue(t))&&setTimeout(function(){return b(i,"<"+l+">")},0)},u(e.element,_),t.forEach(function(e){var t=s("button");if(t.className=n.button,t.innerHTML=e.icon,t.title=e.title,t.setAttribute("type","button"),t.onclick=function(){return e.result()&&_.focus()},e.state){var l=function(){return t.classList[e.state()?"add":"remove"](n.selected)};o(_,"keyup",l),o(_,"mouseup",l),o(t,"click",l)}u(c,t)}),e.styleWithCSS&&b("styleWithCSS"),b(r,l),e.element},m={exec:b,init:_},l.exec=b,l.init=_,l.default=m,Object.defineProperty(l,"__esModule",{value:!0})),n.exports);const h=e(p);class y{init(e){if(null!==e){let t=Array.from((new DOMParser).parseFromString(e.value,"text/html").body.childNodes).some(e=>1===e.nodeType),n=e.getAttribute("data-context");e.classList.add("gtbabel__wysiwyg-textarea"),e.setAttribute("spellcheck","false"),!1===t&&(e.style.display="block"),this.textareaAutoHeight(e);let l=document.createElement("div");if(l.setAttribute("class","gtbabel__wysiwyg gtbabel__wysiwyg--mode-"+(!0===t?"visual":"html")),e.parentNode.insertBefore(l,e.nextSibling),l.appendChild(e),!0===t&&l.insertAdjacentHTML("afterbegin",'\n                <div class="gtbabel__wysiwyg-buttons">\n                    <a class="gtbabel__wysiwyg-button gtbabel__wysiwyg-button--visual" href="#">Visuell</a>\n                    <a class="gtbabel__wysiwyg-button gtbabel__wysiwyg-button--html" href="#">HTML</a>\n                </div>\n            '),l.querySelectorAll(".gtbabel__wysiwyg-button").forEach(t=>{t.addEventListener("click",t=>{t.target.classList.contains("gtbabel__wysiwyg-button--html")&&l.classList.contains("gtbabel__wysiwyg--mode-visual")&&(l.classList.remove("gtbabel__wysiwyg--mode-visual"),l.classList.add("gtbabel__wysiwyg--mode-html"),this.textareaAutoHeight(e)),t.target.classList.contains("gtbabel__wysiwyg-button--visual")&&l.classList.contains("gtbabel__wysiwyg--mode-html")&&(l.classList.remove("gtbabel__wysiwyg--mode-html"),l.classList.add("gtbabel__wysiwyg--mode-visual")),t.preventDefault()})}),"slug"===n&&e.addEventListener("blur",()=>{e.value=this.slugify(e.value)}),!0===t){let t=document.createElement("div");t.setAttribute("class","gtbabel__wysiwyg-editor"),e.hasAttribute("readonly")&&t.classList.add("gtbabel__wysiwyg-editor--readonly"),l.appendChild(t);let n=h.init({element:t,onChange:t=>{t=t.replace(/^<div>/g,"").replace(/<\/div>$/g,"").replace(/<\/div>(\r\n|\r|\n)?<div.*?>/g,"<br/>").replace(/<div.*?>/g,"").replace(/<\/div>/g,""),e.value=t},defaultParagraphSeparator:"div",styleWithCSS:!1,actions:["bold","underline","italic","ulist","olist"]});e.hasAttribute("readonly")&&n.content.removeAttribute("contenteditable"),n.content.innerHTML="<div>"+e.value+"</div>",e.addEventListener("keyup",()=>{n.content.innerHTML="<div>"+e.value+"</div>"})}}}textareaAutoHeight(e){this.textareaSetHeight(e),e.addEventListener("keyup",e=>{this.textareaSetHeight(e.target)})}textareaSetHeight(e){e.style.height="5px",e.style.height=e.scrollHeight+"px"}slugify(e){return e.toString().toLowerCase().trim().split("ä").join("ae").split("ö").join("oe").split("ü").join("ue").split("ß").join("ss").replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}}class v{init(){null!==document.querySelector(".tooltip")&&document.querySelectorAll(".tooltip").forEach(e=>{Array.from(e.childNodes).filter(e=>3===e.nodeType&&e.textContent.trim().length>1).forEach(e=>{const t=document.createElement("p");e.after(t),t.appendChild(e)}),e.innerHTML=`\n                    <div class="tooltip__icon">❓</div>\n                    <div class="tooltip__inner">${e.innerHTML}</div>\n                `,e.style.display="inline-block",e.addEventListener("mouseenter",()=>{let t=e.querySelector(".tooltip__inner");t.style="",t.style.width="300px",t.style.height="auto",t.classList.add("tooltip__inner--visible");let n=document.documentElement.clientWidth||document.body.clientWidth,l=document.documentElement.clientHeight||document.body.clientHeight,a=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0)+window.innerHeight;t.offsetWidth>n&&(t.style.width=n+"px"),t.offsetHeight>l&&(t.style.height=l+"px");let r=Math.ceil(t.getBoundingClientRect().top+window.pageYOffset-document.documentElement.clientTop),i=Math.ceil(t.getBoundingClientRect().left+window.pageXOffset-document.documentElement.clientLeft),o=Math.ceil(t.getBoundingClientRect().left+window.pageXOffset-document.documentElement.clientLeft+t.offsetWidth),u=Math.ceil(t.getBoundingClientRect().top+window.pageYOffset-document.documentElement.clientTop+t.offsetHeight),s=Math.max(n,l);for(;s>0&&(o>n||u>a||i<0||r<0);)o>n&&(t.style.left=parseInt(window.getComputedStyle(t).left)-1+"px",i--,o--),u>a&&(t.style.top=parseInt(window.getComputedStyle(t).top)-1+"px",r--,u--),i<0&&(t.style.left=parseInt(window.getComputedStyle(t).left)+1+"px",i++,o++),r<0&&(t.style.top=parseInt(window.getComputedStyle(t).top)+1+"px",r++,u++),s--}),e.addEventListener("mouseleave",()=>{let t=e.querySelector(".tooltip__inner");t.classList.remove("tooltip__inner--visible"),setTimeout(()=>{t.classList.contains("tooltip__inner--visible")||(t.style="")},300)})})}}const f=new class{init(){document.addEventListener("DOMContentLoaded",()=>{this.initRepeater(),this.initAutoTranslate(),this.initAutoGrab(),this.initSearchMainUrlReset(),this.initFormResetQuestion(),this.initFileUpload(),this.initVideoChange(),this.initFormChange(),this.initFormInverse(),this.initSubmitUnchecked(),this.initWysiwyg(),this.initWizardAutoTranslationChange(),this.initTooltips()})}initRepeater(){document.addEventListener("click",e=>{let t=e.target.closest(".gtbabel__repeater-add");t&&(t.closest(".gtbabel__repeater").querySelector(".gtbabel__repeater-list").insertAdjacentHTML("beforeend",t.closest(".gtbabel__repeater").querySelector(".gtbabel__repeater-listitem:last-child").outerHTML),t.closest(".gtbabel__repeater").querySelector(".gtbabel__repeater-listitem:last-child").classList.remove("gtbabel__repeater-listitem--default"),t.closest(".gtbabel__repeater").querySelector(".gtbabel__repeater-listitem:last-child").classList.remove("gtbabel__repeater-listitem--missing"),t.closest(".gtbabel__repeater").querySelectorAll(".gtbabel__repeater-listitem:last-child input").forEach(e=>{e.value="",e.hasAttribute("disabled")||e.removeAttribute("readonly"),e.hasAttribute("data-name")&&(e.setAttribute("name",e.getAttribute("data-name")),e.removeAttribute("data-name"))}),e.preventDefault())}),document.addEventListener("click",e=>{let t=e.target.closest(".gtbabel__repeater-action--remove");t&&(t.closest(".gtbabel__repeater").querySelectorAll(".gtbabel__repeater-listitem").length>1?t.parentNode.remove():t.parentNode.querySelectorAll(".gtbabel__input").forEach(e=>{e.value=""}),e.preventDefault())}),document.addEventListener("click",e=>{let t=e.target.closest(".gtbabel__repeater-action--enable, .gtbabel__repeater-action--disable");t&&(t.closest(".gtbabel__repeater-listitem").querySelectorAll(".gtbabel__input").forEach(e=>{t.classList.contains("gtbabel__repeater-action--enable")?(t.closest(".gtbabel__repeater-listitem").classList.remove("gtbabel__repeater-listitem--missing"),e.setAttribute("name",e.getAttribute("data-name")),e.removeAttribute("data-name")):(t.closest(".gtbabel__repeater-listitem").classList.add("gtbabel__repeater-listitem--missing"),e.setAttribute("data-name",e.getAttribute("name")),e.removeAttribute("name"))}),e.preventDefault())})}initAutoTranslate(){document.addEventListener("click",e=>{let t=e.target.closest(".gtbabel__submit--auto-translate");if(t){null!==document.querySelector(".gtbabel__auto-translate")&&document.querySelector(".gtbabel__auto-translate").remove(),t.insertAdjacentHTML("afterend",'<div class="gtbabel__auto-translate" data-error-text="'+t.getAttribute("data-error-text")+'">'+t.getAttribute("data-loading-text")+"</div>");let n=t.getAttribute("data-href");null!==document.querySelector("#gtbabel_delete_unused")&&!0===document.querySelector("#gtbabel_delete_unused").checked&&(n+="&gtbabel_delete_unused=1"),null!==document.querySelector("#gtbabel_auto_set_discovered_strings_checked")&&!0!==document.querySelector("#gtbabel_auto_set_discovered_strings_checked").checked||(n+="&gtbabel_auto_set_discovered_strings_checked=1"),t.remove(),this.fetchNextAutoTranslate(n),e.preventDefault()}})}fetchNextAutoTranslate(e,t=0){t>10?null!==document.querySelector(".gtbabel__auto-translate")&&(document.querySelector(".gtbabel__auto-translate").innerHTML='<span class="gtbabel__auto-translate-error">'+document.querySelector(".gtbabel__auto-translate").getAttribute("data-error-text")+"</span>"):fetch(e).then(e=>200==e.status||304==e.status?e.text():null).catch(()=>null).then(n=>{let l=null;null===n&&void 0===n&&""==n||(l=(new DOMParser).parseFromString(n,"text/html")),null===l||null===l.querySelector(".gtbabel__auto-translate")?setTimeout(()=>{this.fetchNextAutoTranslate(e,t+1)},3e3):(null!==document.querySelector(".gtbabel__auto-translate")&&null!==l.querySelector(".gtbabel__auto-translate")&&(document.querySelector(".gtbabel__auto-translate").innerHTML=l.querySelector(".gtbabel__auto-translate").innerHTML),null!==document.querySelector(".gtbabel__stats-log")&&null!==l.querySelector(".gtbabel__stats-log")&&(document.querySelector(".gtbabel__stats-log").innerHTML=l.querySelector(".gtbabel__stats-log").innerHTML),null!==l.querySelector(".gtbabel__auto-translate-next")&&this.fetchNextAutoTranslate(l.querySelector(".gtbabel__auto-translate-next").getAttribute("href")))})}initAutoGrab(){document.addEventListener("click",e=>{let t=e.target.closest(".gtbabel__submit--auto-grab");if(t){null!==document.querySelector(".gtbabel__auto-grab")&&document.querySelector(".gtbabel__auto-grab").remove(),t.insertAdjacentHTML("afterend",'<div class="gtbabel__auto-grab" data-error-text="'+t.getAttribute("data-error-text")+'">'+t.getAttribute("data-loading-text")+"</div>");let n=t.getAttribute("data-href");null!==document.querySelector("#gtbabel_auto_grab_url")&&""!=document.querySelector("#gtbabel_auto_grab_url").value&&(n+="&gtbabel_auto_grab_url="+document.querySelector("#gtbabel_auto_grab_url").value),null!==document.querySelector("#gtbabel_auto_grab_dry_run")&&!0===document.querySelector("#gtbabel_auto_grab_dry_run").checked&&(n+="&gtbabel_auto_grab_dry_run=1"),t.remove(),this.fetchNextAutoGrab(n),e.preventDefault()}})}fetchNextAutoGrab(e,t=0){t>10?null!==document.querySelector(".gtbabel__auto-grab")&&(document.querySelector(".gtbabel__auto-grab").innerHTML='<span class="gtbabel__auto-grab-error">'+document.querySelector(".gtbabel__auto-grab").getAttribute("data-error-text")+"</span>"):fetch(e).then(e=>200==e.status||304==e.status?e.text():null).catch(()=>null).then(n=>{let l=null;null===n&&void 0===n&&""==n||(l=(new DOMParser).parseFromString(n,"text/html")),null===l||null===l.querySelector(".gtbabel__auto-grab")?setTimeout(()=>{this.fetchNextAutoGrab(e,t+1)},3e3):(null!==document.querySelector(".gtbabel__auto-grab")&&null!==l.querySelector(".gtbabel__auto-grab")&&(document.querySelector(".gtbabel__auto-grab").innerHTML=l.querySelector(".gtbabel__auto-grab").innerHTML),null!==l.querySelector(".gtbabel__auto-grab-next")&&this.fetchNextAutoGrab(l.querySelector(".gtbabel__auto-grab-next").getAttribute("href")))})}initFileUpload(){document.addEventListener("click",e=>{let t=e.target.closest(".gtbabel__file-info-upload");if(t){let n;n&&n.open(),n=wp.media({multiple:!1}),n.on("close",()=>{let e=null,l=n.state().get("selection"),a=t.closest(".gtbabel__table-cell").querySelector(".gtbabel__file-info-img"),r=t.closest(".gtbabel__table-cell").querySelector(".gtbabel__input--textarea"),i=null!==r&&0===r.value.indexOf("http");l.length>0&&l.forEach(t=>{e=t.attributes.url}),null!==e&&(a.setAttribute("src",e),!1===i&&(e=e.replace(window.location.protocol+"//"+window.location.host,""),e=e.replace(/^\/+|\/+$/g,"")),r.value=e,r.dispatchEvent(new Event("change",{bubbles:!0})))}),n.open(),e.preventDefault()}})}initVideoChange(){null!==document.querySelector(".gtbabel__video-id")&&document.querySelectorAll(".gtbabel__video-id").forEach(e=>{e.addEventListener("keyup",()=>{e.closest(".gtbabel__video-info").previousElementSibling.value=e.getAttribute("data-str-orig").split(e.getAttribute("data-id-orig")).join(e.value),e.closest(".gtbabel__video-info").previousElementSibling.dispatchEvent(new Event("change",{bubbles:!0}))})})}initSearchMainUrlReset(){document.addEventListener("click",e=>{e.target.closest(".gtbabel__transmeta-reset")&&(document.querySelector('.gtbabel__form input[name="url"]').value="",document.querySelector('.gtbabel__form input[name="p"]').value="",document.querySelector('.gtbabel__form input[name="post_id"]').value="",document.querySelector(".gtbabel__form").submit(),e.preventDefault())})}initFormResetQuestion(){document.addEventListener("click",e=>{let t=e.target.closest(".gtbabel__submit--reset");if(t){"REMOVE"!==prompt(t.getAttribute("data-question"))&&e.preventDefault()}})}initFormChange(){document.addEventListener("change",e=>{e.target.closest(".gtbabel__input--on-change")&&e.target.setAttribute("name",e.target.getAttribute("data-name"))})}initFormInverse(){document.addEventListener("change",e=>{e.target.closest(".gtbabel__input--inverse")&&(e.target.nextElementSibling.value=!0===e.target.checked?"0":"1")})}initSubmitUnchecked(){document.addEventListener("submit",e=>{if(e.target.closest(".gtbabel__form")){let t=null;t=e.target.closest(".gtbabel__form").querySelectorAll(".gtbabel__input--submit-unchecked:not(:checked)[name]:not([name$='[]']):not([disabled=\"disabled\"])"),t.length>0&&t.forEach(e=>{null!==e.previousElementSibling&&"hidden"===e.previousElementSibling.getAttribute("type")&&"0"==e.previousElementSibling.value||e.insertAdjacentHTML("beforebegin",'<input type="hidden" value="0" name="'+e.getAttribute("name")+'" />')})}})}initWysiwyg(){null!==document.querySelector(".gtbabel__wysiwyg-textarea")&&document.querySelectorAll(".gtbabel__wysiwyg-textarea").forEach(e=>{(new y).init(e)})}initWizardAutoTranslationChange(){let e=document.querySelector(".gtbabel__input--wizard-auto-translation-service-provider");null!==e&&(this.initWizardAutoTranslationChangeUpdate(e),e.addEventListener("change",t=>{this.initWizardAutoTranslationChangeUpdate(e)}))}initWizardAutoTranslationChangeUpdate(e){let t=e.closest("form").querySelector(".gtbabel__input--wizard-auto-translation-service-api-key");t.style.display="manual"===e.value||"custom"===e.value?"none":"inline-block",t.required="manual"!==e.value&&"custom"!==e.value,t.value=e.options[e.selectedIndex].getAttribute("data-api-key")}initTooltips(){(new v).init()}};f.init()}();